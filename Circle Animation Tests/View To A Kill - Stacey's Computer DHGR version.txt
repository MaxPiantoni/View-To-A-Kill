01 REM STACEY'S COMPUTER FROM A VIEW TO A KILL
02 REM BY MAX PIANTONI

05  PRINT CHR$(4); "BLOAD DHGR"               : REM load Beagle Bros DHGR into memory

10  REM Screen Setup
15      HOME
20      & HGR2                                     : REM Hi-Res Graphics
25      POKE 49234,0                            : REM switch to full screen graphics (hide text window)
30      & HCOLOR = 15                              : REM Set the color we will draw in
35      SX = 559                                : REM The width of the screen in points
40      SY = 191                                : REM The height of the screen in points    

41 REM  Load the map image to HGR page 2
42      PRINT CHR$(4)"BLOADTESTINVERT.PIC,A$4000"     : REM Load map to HGR page 2 ($A2000 loads to page 1)

44 REM  Load the font shape table from the floppy. The font used is ']SMALL STANDARD' from the Beagle Bros. Apple Mechanic.     
45      SH = 25000 : D$ = CHR$ (4)              : REM SH = Start position in memory
46      PRINT D$;"BLOAD STANDARD FONT,A";SH     : REM Load the font shape table into memory
47      POKE 232,SH - INT (SH / 256) * 256      : REM Set the flags for the start of the shape table in memory   
48      POKE 233, INT (SH / 256)                : REM Set the flags for the end of the shape table in memory  

50  REM Graph Setup
55      DIM PMID(2)                             : REM An array to store the position of the line for each plot
60      PMID(0) = 31
65      PMID(1) = 96
70      PMID(2) = 160
75      MID = PMID(0)                            : REM The y midpoint of the curent plot

100 REM Draw horizontal graph Lines 
110 REM in the film these are drawn first, in a ping-pong pattern
110     & HPLOT 0,MID TO SX,MID
120     MID = PMID(1)
130     & HPLOT SX,MID TO 0,MID
140     MID = PMID(2)
150     & HPLOT 0,MID TO SX,MID
160     MID = PMID(0)

200 REM Setup Plots
210     P = 0                                   : REM The current line of the plot
220     DIM PCOUNT(2)                           : REM The amount of data in each graph
221     PCOUNT(0) = 63
222     PCOUNT(1) = 63
223     PCOUNT(2) = 63

300 REM Read and plot data on the graph lines
301     I = 0                                   : REM Keep track of how many points we have plotted     
310     READ A,B                                : REM Read data for first point
315     I = 1
320 REM LOOP START
330     READ C,D                                : REM read data for second point                                              
340     & HPLOT A,(B + MID)                       : REM Plot start point
350     & HPLOT C,(D + MID)                       : REM Plot end point
360     & HPLOT A,(B + MID) TO C,(D + MID)        : REM Draw line
370     A = C : B = D                           : REM Set the end point of this line to be the start point for the next line
380     I = I + 2                               : REM count the number of points we have plotted so far
390     IF I = PCOUNT(P) THEN GOTO 500          : REM If we have plotted the data for this graph, get ready to plot the next graph   
410     GOTO 320                                : Plot the next point in this graph

500 REM Logic for advancing to the next plot
510     IF P > 1 GOTO 600                       : REM If this is the last of the three graphs, stop plotting
520     IF I = PCOUNT(P) THEN MID = PMID(P + 1) : REM Advance the midpoint to that of the next graph
530     IF I = PCOUNT(P) THEN P = P + 1         : REM Advance to the next graph
540     IF I = PCOUNT(P - 1) GOTO 300           : Rem plot the next graph

600 REM Draw the line of text below the graph
601 REM characters are: d = 9km   m = 2.5:
610     SCALE = 1: ROT = 0                      : REM Shape table drawing setup
620     TX = 0 : TY = 183                       : REM The start position for the drawing of the shapes
630     FOR V = 0 TO 37 STEP 1                  : REM Loop through the character data and draw the characters  
640     READ C                                  : REM Get the shape table index of the character to be drawn from data
650     & DRAW C AT TX,TY                         : REM Draw the character from the shape table 
660     TX = TX + 7                             : REM Advance the cursor position    
670     NEXT V

700 REM Transition to the map page
701 REM This should be drawn beforehand on HGR Screen 2 so it can be switched to instantly as in the movie - loaded from a .pic with baked in text.
702 REM Circles should be shape table animations
705     GET KB$                                 : REM Wait for user to press a key on the keyboard
710     CALL -3086                              : REM Clear screen to black as in movie    
715     POKE 49237,1                            : REM Display graphics page 2

750 REM Map screen animations
760     SCALE = 1: ROT = 0
761     & HPLOT 0,54 TO SX,54                     : REM Draw a placeholder line to test flashing anim
765     POKE 49236,0                            : REM Display graphics page 1
767 REM
770     & XDRAW 80 AT 50,50                       : REM Draw the character from the shape table 
780     FOR T = 0 TO 400 STEP 1 : NEXT T        : REM Delay for animation  
800     GOTO 767

900     END

1000 REM Data for plot line 1 - a series of x,y positions
1001    DATA    30,0,  35,2,   40,0,   45,-2,  55,0,   56,-25, 58,25,  59,-20
1002    DATA    60,21, 62,-15, 64,15,  66,-10, 69,10,  72,-8,  74,8,   78,-5
1003    DATA    80,2,  90,-2
1004    DATA    92,0,  94,25,  95,-25, 96,22,  98,-18, 98,-18, 100,10, 103,-8
1005    DATA    105,5, 108,-5, 118,3,  120,0,  140,3,  155,0    

2000 REM Data for plot line 2 - a series of x,y positions   
2001    DATA    30,0,  35,2,   40,0,   45,-2,  55,0,   56,-25, 58,25,  59,-20
2002    DATA    60,21, 62,-15, 64,15,  66,-10, 69,10,  72,-8,  74,8,   78,-5
2003    DATA    80,2,  90,-2
2004    DATA    92,0,  94,25,  95,-25, 96,22,  98,-18, 98,-18, 100,10, 103,-8
2005    DATA    105,5, 108,-5, 118,3,  120,0,  140,3,  155,0 

3000 REM Data for plot line 3 - a series of x,y positions   
3001    DATA    30,0,  35,2,   40,0,   45,-2,  55,0,   56,-25, 58,25,  59,-20
3002    DATA    60,21, 62,-15, 64,15,  66,-10, 69,10,  72,-8,  74,8,   78,-5
3003    DATA    80,2,  90,-2
3004    DATA    92,0,  94,25,  95,-25, 96,22,  98,-18, 98,-18, 100,10, 103,-8
3005    DATA    105,5, 108,-5, 118,3,  120,0,  140,3,  155,0 

4000 REM Data for text at bottom of graph screen (d = 9km m = 2.5)
4001    DATA    69,1,30,1,26,76,78 
4002    DATA    1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
4003    DATA    78,1,30,1,19,15,22
